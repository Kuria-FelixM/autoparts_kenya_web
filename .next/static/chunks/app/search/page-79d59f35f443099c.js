(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[959],{5229:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5231:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var r=s(5155),a=s(2115),l=s(63),n=s(5229),i=s(9540),c=s(6651);let o=(0,s(1847).A)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);var d=s(7258);function u(e){let{value:t,onChange:s,onSubmit:l,placeholder:i="Search parts, tires, batteries...",className:u,enableVoiceSearch:h=!0}=e,[g,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(!1),b=(0,a.useRef)(null);(0,a.useEffect)(()=>{p(!!(window.SpeechRecognition||window.webkitSpeechRecognition)&&h)},[h]);let f=async()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)return;let t=new e;t.lang="en-KE",t.onstart=()=>m(!0),t.onend=()=>m(!1),t.onerror=()=>m(!1),t.onresult=e=>{let t="";for(let s=e.resultIndex;s<e.results.length;s++)t+=e.results[s][0].transcript;t&&(s(t),l&&l(t))},g?t.stop():t.start()};return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l&&l(t)},className:(0,d.cn)("relative flex items-center gap-2",u),children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(c.A,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-road-grey-500 pointer-events-none"}),(0,r.jsx)("input",{ref:b,type:"text",value:t,onChange:e=>s(e.target.value),placeholder:i,className:"w-full py-3 pl-10 pr-10 rounded-lg border border-road-grey-300 bg-white text-sm placeholder-road-grey-500 focus:border-mechanic-blue focus:outline-none focus:ring-1 focus:ring-mechanic-blue transition-colors","aria-label":"Search parts"}),t&&(0,r.jsx)("button",{type:"button",onClick:()=>{var e;s(""),null==(e=b.current)||e.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-road-grey-500 hover:text-road-grey-700 p-1 transition-colors","aria-label":"Clear search",children:(0,r.jsx)(n.A,{className:"h-4 w-4"})})]}),x&&(0,r.jsx)("button",{type:"button",onClick:f,className:(0,d.cn)("flex items-center justify-center h-11 w-11 rounded-lg border transition-all",g?"bg-reliable-red text-white border-reliable-red animate-pulse":"border-road-grey-300 text-road-grey-600 hover:border-mechanic-blue hover:text-mechanic-blue"),"aria-label":g?"Stop listening":"Start voice search",title:g?"Listening...":"Voice search",children:(0,r.jsx)(o,{className:"h-5 w-5"})})]})}var h=s(4033);function g(e){let{title:t,items:s,selected:l,onSelect:i,isOpen:c=!1,onToggle:o,type:u="checkbox",minValue:g,maxValue:m,step:x=1e3,isMultiSelect:p=!0}=e,[b,f]=(0,a.useState)(c),[y,j]=(0,a.useState)([g||0,m||1e5]),v=void 0!==o,w=v?c:b,k=(e,t)=>{let s=[...y];s[e]=t,s[0]<=s[1]&&(j(s),i(s))},N="range"!==u&&l.length>0;return(0,r.jsxs)("div",{className:"border-b border-road-grey-300",children:[(0,r.jsxs)("button",{onClick:()=>{v?null==o||o(!w):f(!b)},className:"w-full flex items-center justify-between py-4 px-4 hover:bg-road-grey-100 transition-colors","aria-expanded":w,"aria-controls":"filter-".concat(t.replace(/\s+/g,"-").toLowerCase()),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,r.jsx)("span",{className:(0,d.cn)("font-semibold text-sm",N&&"text-mechanic-blue"),children:t}),N&&(0,r.jsx)("span",{className:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-mechanic-blue text-white text-xs font-bold",children:l.length})]}),(0,r.jsx)(h.A,{className:(0,d.cn)("h-5 w-5 text-road-grey-600 transition-transform",w&&"rotate-180")})]}),w&&(0,r.jsx)("div",{id:"filter-".concat(t.replace(/\s+/g,"-").toLowerCase()),className:"px-4 pb-4 space-y-3 bg-road-grey-50",children:"range"===u?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"text-xs font-semibold text-road-grey-700 mb-2 block",children:["Min: KSh ",y[0].toLocaleString()]}),(0,r.jsx)("input",{type:"range",min:g||0,max:m||1e5,step:x,value:y[0],onChange:e=>k(0,parseInt(e.target.value)),className:"w-full accent-mechanic-blue"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"text-xs font-semibold text-road-grey-700 mb-2 block",children:["Max: KSh ",y[1].toLocaleString()]}),(0,r.jsx)("input",{type:"range",min:g||0,max:m||1e5,step:x,value:y[1],onChange:e=>k(1,parseInt(e.target.value)),className:"w-full accent-mechanic-blue"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-white cursor-pointer transition-colors",children:[(0,r.jsx)("input",{type:"radio"===u?"radio":"checkbox",name:t,checked:l.includes(e.id),onChange:()=>{var t;return t=e.id,void(p?i(l.includes(t)?l.filter(e=>e!==t):[...l,t]):i(l.includes(t)?[]:[t]))},className:"w-4 h-4 text-mechanic-blue rounded accent-mechanic-blue cursor-pointer"}),(0,r.jsx)("span",{className:"flex-1 text-sm text-road-grey-900",children:e.label}),void 0!==e.count&&(0,r.jsxs)("span",{className:"text-xs text-road-grey-500",children:["(",e.count,")"]})]},e.id))}),N&&(0,r.jsxs)("button",{onClick:()=>{i([]),j([g||0,m||1e5])},className:"w-full flex items-center justify-center gap-2 py-2 text-sm text-mechanic-blue hover:text-mechanic-blue/80 font-medium transition-colors",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),"Clear"]})]})})]})}function m(e){let{options:t,value:s,onChange:l,label:n="Sort By",className:i}=e,[c,o]=(0,a.useState)(!1),u=(0,a.useRef)(null),g=t.find(e=>e.id===s);return(0,a.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&o(!1)};if(c)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[c]),(0,r.jsxs)("div",{className:(0,d.cn)("relative",i),ref:u,children:[(0,r.jsxs)("button",{onClick:()=>o(!c),className:"flex items-center gap-2 px-4 py-2 rounded-lg border border-road-grey-300 bg-white text-sm font-medium text-road-grey-900 hover:border-mechanic-blue hover:text-mechanic-blue transition-colors","aria-expanded":c,"aria-haspopup":"listbox",children:[(0,r.jsx)("span",{children:(null==g?void 0:g.label)||n}),(0,r.jsx)(h.A,{className:(0,d.cn)("h-4 w-4 transition-transform",c&&"rotate-180")})]}),c&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-road-grey-300 rounded-lg shadow-lg z-50",role:"listbox",children:t.map(e=>(0,r.jsxs)("button",{onClick:()=>{l(e.id),o(!1)},className:(0,d.cn)("w-full flex items-center gap-2 px-4 py-3 text-sm text-left transition-colors first:rounded-t-lg last:rounded-b-lg",s===e.id?"bg-mechanic-blue/10 text-mechanic-blue font-semibold":"text-road-grey-900 hover:bg-road-grey-50"),role:"option","aria-selected":s===e.id,children:[e.icon&&(0,r.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))})]})}var x=s(7392),p=s(8214),b=s(7671),f=s(277),y=s(6549),j=s(2663);let v=[{id:"newest",label:"Newest"},{id:"price-asc",label:"Price: Low to High"},{id:"price-desc",label:"Price: High to Low"},{id:"popular",label:"Most Popular"},{id:"rating",label:"Highest Rated"}],w=[{id:"in-stock",label:"In Stock"},{id:"low-stock",label:"Low Stock"}];function k(){let e=(0,l.useSearchParams)(),[t,s]=(0,a.useState)({search:e.get("q")||"",makes:[],categories:e.get("category")?[e.get("category")]:[],priceRange:[0,1e5],stock:[],sort:"newest"}),[c,o]=(0,a.useState)([]),[d,h]=(0,a.useState)([]),[k,N]=(0,a.useState)(!0),[S,C]=(0,a.useState)([]),[A,R]=(0,a.useState)(!1),[_,L]=(0,a.useState)(!1),[E,M]=(0,a.useState)(!0),[P,I]=(0,a.useState)(1),[F,V]=(0,a.useState)(!1),O=(0,a.useRef)(null);(0,a.useEffect)(()=>{z()},[]);let z=async()=>{N(!0);try{let e=await f.PI.getVehicleMakes(),t=e.data.results||e.data,s=(Array.isArray(t)?t:[]).map(e=>({id:e.id,label:e.name,count:e.models_count||0}));o(s);let r=await f.PI.getCategories(),a=r.data.results||r.data,l=(Array.isArray(a)?a:[]).map(e=>({id:e.id,label:e.name,count:e.products_count||0}));h(l)}catch(t){console.error("Failed to fetch filter options:",t);let e=(0,f.hS)(t);j.oR.error(e)}finally{N(!1)}};(0,a.useEffect)(()=>{I(1),C([]),q(1,!0)},[t.search,t.makes,t.categories,t.priceRange,t.stock,t.sort]);let q=(0,a.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];1===e&&s?R(!0):L(!0);try{let r={page:e,page_size:y.Bq.DEFAULT_PAGE_SIZE};t.search&&(r.search=t.search),t.categories.length>0&&(r.categories=t.categories.join(",")),t.makes.length>0&&(r.vehicle_make=t.makes[0]),t.priceRange[0]>0&&(r.min_price=t.priceRange[0]),t.priceRange[1]<1e5&&(r.max_price=t.priceRange[1]),t.stock.includes("in-stock")&&(r.in_stock=!0),r.ordering="price-asc"===t.sort?"price":"price-desc"===t.sort?"-price":"rating"===t.sort?"-rating":"popular"===t.sort?"-review_count":"-created_at";let a=(await f.PI.getProducts(r)).data;s?C(a.results||[]):C(e=>[...e,...a.results||[]]),M(!!a.next)}catch(t){let e=(0,f.hS)(t);j.oR.error(e)}finally{R(!1),L(!1)}},[t]);(0,a.useEffect)(()=>{let e=new IntersectionObserver(e=>{if(e[0].isIntersecting&&E&&!A&&!_){let e=P+1;I(e),q(e)}},{threshold:.1});return O.current&&e.observe(O.current),()=>e.disconnect()},[E,A,_,P,q]);let H=(e,t)=>{s(s=>({...s,[e]:t}))},K=()=>{s({search:"",makes:[],categories:[],priceRange:[0,1e5],stock:[],sort:"newest"}),V(!1)},T=t.makes.length+t.categories.length+ +(t.stock.length>0)+ +(t.priceRange[0]>0||t.priceRange[1]<1e5);return(0,r.jsxs)("div",{className:"min-h-screen bg-road-grey-100 pb-20 md:pb-0",children:[(0,r.jsx)("div",{className:"sticky top-0 z-30 bg-white border-b border-road-grey-200 p-4 md:hidden",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(u,{value:t.search,onChange:e=>H("search",e),onSubmit:e=>H("search",e),className:"flex-1"}),(0,r.jsxs)("button",{onClick:()=>V(!F),className:"flex items-center justify-center h-11 w-11 rounded-lg border border-road-grey-300 hover:border-mechanic-blue text-road-grey-600 hover:text-mechanic-blue transition-colors relative","aria-label":"Toggle filters",children:[F?(0,r.jsx)(n.A,{className:"h-5 w-5"}):(0,r.jsx)(i.A,{className:"h-5 w-5"}),T>0&&(0,r.jsx)("span",{className:"absolute -top-2 -right-2 h-5 w-5 rounded-full bg-reliable-red text-white text-xs font-bold flex items-center justify-center",children:T})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 p-4",children:[(0,r.jsxs)("div",{className:"hidden md:block col-span-1 bg-white rounded-lg border border-road-grey-200 h-fit sticky top-20",children:[(0,r.jsx)("div",{className:"p-4 border-b border-road-grey-200",children:(0,r.jsx)(u,{value:t.search,onChange:e=>H("search",e),onSubmit:e=>H("search",e),className:"w-full"})}),(0,r.jsx)("div",{className:"p-4 space-y-4 max-h-[70vh] overflow-y-auto",children:k?(0,r.jsx)("div",{className:"flex justify-center py-8",children:(0,r.jsx)(p.A,{message:"Loading filters..."})}):(0,r.jsxs)(r.Fragment,{children:[c.length>0&&(0,r.jsx)(g,{title:"Vehicle Make",items:c,selected:t.makes,onSelect:e=>H("makes",e)}),d.length>0&&(0,r.jsx)(g,{title:"Category",items:d,selected:t.categories,onSelect:e=>H("categories",e),isMultiSelect:!0}),(0,r.jsx)(g,{title:"Price Range",items:[],selected:t.priceRange,onSelect:e=>H("priceRange",e),type:"range",minValue:0,maxValue:1e5,step:5e3}),(0,r.jsx)(g,{title:"Stock Status",items:w,selected:t.stock,onSelect:e=>H("stock",e)}),T>0&&(0,r.jsx)("button",{onClick:K,className:"w-full py-2 px-4 rounded-lg bg-road-grey-100 text-road-grey-900 hover:bg-road-grey-200 text-sm font-medium transition-colors",children:"Clear All Filters"})]})})]}),F&&(0,r.jsx)("div",{className:"fixed inset-0 top-24 z-40 bg-white md:hidden overflow-y-auto pb-20",children:(0,r.jsx)("div",{className:"p-4 space-y-4",children:k?(0,r.jsx)("div",{className:"flex justify-center py-8",children:(0,r.jsx)(p.A,{message:"Loading filters..."})}):(0,r.jsxs)(r.Fragment,{children:[c.length>0&&(0,r.jsx)(g,{title:"Vehicle Make",items:c,selected:t.makes,onSelect:e=>H("makes",e),isOpen:!0}),d.length>0&&(0,r.jsx)(g,{title:"Category",items:d,selected:t.categories,onSelect:e=>H("categories",e),isOpen:!0}),(0,r.jsx)(g,{title:"Price Range",items:[],selected:t.priceRange,onSelect:e=>H("priceRange",e),type:"range",minValue:0,maxValue:1e5,step:5e3,isOpen:!0}),(0,r.jsx)(g,{title:"Stock Status",items:w,selected:t.stock,onSelect:e=>H("stock",e),isOpen:!0}),T>0&&(0,r.jsx)("button",{onClick:K,className:"w-full py-2 px-4 rounded-lg bg-road-grey-100 text-road-grey-900 hover:bg-road-grey-200 text-sm font-medium transition-colors",children:"Clear All Filters"})]})})}),(0,r.jsxs)("div",{className:"col-span-1 md:col-span-3 space-y-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-road-grey-200 p-4 flex items-center justify-between",children:[(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-sm text-road-grey-600",children:S&&S.length>0?"Showing ".concat(S.length," results"):"No products found"})}),(0,r.jsx)(m,{options:v,value:t.sort,onChange:e=>H("sort",e),className:"hidden sm:block"})]}),(0,r.jsx)("div",{className:"md:hidden",children:(0,r.jsx)(m,{options:v,value:t.sort,onChange:e=>H("sort",e),className:"w-full"})}),A?(0,r.jsx)(p.A,{fullScreen:!0,message:"Loading products..."}):S&&0!==S.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4",children:S.map(e=>(0,r.jsx)(x.A,{...e},e.id))}),(0,r.jsxs)("div",{ref:O,className:"py-8",children:[_&&(0,r.jsx)(p.A,{message:"Loading more..."}),!E&&S.length>0&&(0,r.jsx)("p",{className:"text-center text-road-grey-600 text-sm",children:"You've reached the end"})]})]}):(0,r.jsx)(b.A,{type:"no-results",title:"No parts found",description:"Try adjusting your filters or search term",action:{label:"Clear Filters",onClick:K}})]})]})]})}function N(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(p.A,{fullScreen:!0,message:"Loading search..."}),children:(0,r.jsx)(k,{})})}},5690:(e,t,s)=>{Promise.resolve().then(s.bind(s,5231))},6651:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9540:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1847).A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])}},e=>{e.O(0,[619,8,663,44,473,49,185,623,358],()=>e(e.s=5690)),_N_E=e.O()}]);