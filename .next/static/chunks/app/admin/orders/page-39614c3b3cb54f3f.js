(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(2115);let s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:o=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:d="",children:c,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...l,width:o,height:o,stroke:r,strokeWidth:i?24*Number(n)/Number(o):n,className:s("lucide",d),...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),n=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:n,...i}=r;return(0,a.createElement)(o,{ref:l,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),n),...i})});return r.displayName="".concat(e),r}},4143:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(5155),s=r(2115),l=r(63),o=r(2619),n=r.n(o);let i=(0,r(1847).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var d=r(3875),c=r(8214),u=r(7671),m=r(8406),h=r(277),x=r(4659),p=r(2663);let y=[{value:"pending",label:"Pending",color:"warning-orange"},{value:"confirmed",label:"Confirmed",color:"info-cyan"},{value:"processing",label:"Processing",color:"mechanic-blue"},{value:"shipped",label:"Shipped",color:"mechanic-blue"},{value:"delivered",label:"Delivered",color:"success-green"},{value:"cancelled",label:"Cancelled",color:"road-grey-500"}];function g(){let e=(0,l.useRouter)(),{user:t,isAuthenticated:r}=(0,m.n)(),[o,g]=(0,s.useState)([]),[b,f]=(0,s.useState)(!0),[v,N]=(0,s.useState)("all");(0,s.useEffect)(()=>{var a;if(!r||!(null==t||null==(a=t.profile)?void 0:a.is_owner))return void e.push("/auth/login");j()},[r,t,e]);let j=async()=>{try{var e;f(!0);let t=h.PI.adminGetOrders?await h.PI.adminGetOrders():[],r=Array.isArray(t)?t:(null==t||null==(e=t.data)?void 0:e.results)||(null==t?void 0:t.results)||[];g(r)}catch(e){g([{id:1,order_number:"ORD-001",guest_phone:"0722123456",delivery_address:"123 Main St, Nairobi",delivery_city:"Nairobi",delivery_postal_code:"00100",recipient_name:"John Doe",recipient_phone:"0722123456",subtotal:15e3,delivery_cost:1500,total_amount:16500,order_status:"pending",payment_status:"paid",customer_email:"john@example.com",customer_phone:"0722123456",item_count:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),items:[]}])}finally{f(!1)}},w=async(e,t)=>{try{p.oR.success("Order status updated to ".concat(t)),j()}catch(e){p.oR.error("Failed to update order")}},_="all"===v?o:o.filter(e=>e.order_status===v);return b?(0,a.jsx)(c.A,{fullScreen:!0,message:"Loading orders..."}):(0,a.jsx)("div",{className:"min-h-screen bg-road-grey-100 p-6",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-road-grey-900",children:"Orders"}),(0,a.jsxs)("p",{className:"text-road-grey-600 mt-2",children:[o.length," total orders"]})]}),(0,a.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[(0,a.jsxs)("button",{onClick:()=>N("all"),className:"px-4 py-2 rounded-full font-bold transition-colors whitespace-nowrap ".concat("all"===v?"bg-mechanic-blue text-white":"bg-white border border-road-grey-300 text-road-grey-900 hover:border-mechanic-blue"),children:["All Orders (",o.length,")"]}),y.map(e=>{let t=o.filter(t=>t.order_status===e.value).length;return(0,a.jsxs)("button",{onClick:()=>N(e.value),className:"px-4 py-2 rounded-full font-bold transition-colors whitespace-nowrap ".concat(v===e.value?"bg-mechanic-blue text-white":"bg-white border border-road-grey-300 text-road-grey-900 hover:border-mechanic-blue"),children:[e.label," (",t,")"]},e.value)})]}),0===_.length?(0,a.jsx)(u.A,{type:"no-orders",title:"No orders to display",description:"all"===v?"Start selling to see orders here":'No orders with status "'.concat(v,'"')}):(0,a.jsx)(d.A,{className:"overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-road-grey-50 border-b border-road-grey-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left font-bold text-road-grey-900",children:"Order #"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left font-bold text-road-grey-900",children:"Customer"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left font-bold text-road-grey-900",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left font-bold text-road-grey-900",children:"Items"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left font-bold text-road-grey-900",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left font-bold text-road-grey-900",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right font-bold text-road-grey-900",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:_.map(e=>{var t;let r=(null==(t=e.items)?void 0:t.length)||0;return(0,a.jsxs)("tr",{className:"border-b border-road-grey-200 hover:bg-road-grey-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("p",{className:"font-bold font-mono text-road-grey-900",children:e.order_number})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-road-grey-900",children:e.guest_phone||"N/A"}),(0,a.jsx)("p",{className:"text-sm text-road-grey-600",children:e.delivery_city})]})}),(0,a.jsx)("td",{className:"px-6 py-4 font-bold text-reliable-red",children:(0,x.gh)(e.total_amount)}),(0,a.jsxs)("td",{className:"px-6 py-4 text-road-grey-700",children:[r," items"]}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("select",{value:e.order_status,onChange:t=>w(e.id,t.target.value),className:"px-3 py-1 rounded-full text-sm font-bold border border-road-grey-300 focus:outline-none focus:ring-1 focus:ring-mechanic-blue",children:y.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})}),(0,a.jsx)("td",{className:"px-6 py-4 text-road-grey-600",children:(0,x.Yq)(e.created_at)}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,a.jsx)(n(),{href:"/orders/".concat(e.id),children:(0,a.jsx)("button",{className:"p-2 text-mechanic-blue hover:bg-mechanic-blue/10 rounded-lg transition-colors",title:"View details",children:(0,a.jsx)(i,{className:"h-5 w-5"})})})})})]},e.id)})})]})})})]})})}},4659:(e,t,r)=>{"use strict";r.d(t,{Xq:()=>i,Yq:()=>o,g0:()=>l,gh:()=>a,h2:()=>s,w_:()=>n});let a=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!Number.isFinite(e))return"KSh 0";let r=new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0,maximumFractionDigits:2}).format(e);return t?r.replace("KES","KSh").trim():r.replace("KES","").trim()},s=e=>{let t=e.replace(/\D/g,"");return t.startsWith("0")&&(t="254"+t.substring(1)),t.startsWith("254")||(t="254"+t),t},l=e=>{let t=s(e);return/^254[0-9]{9}$/.test(t)},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short",r="string"==typeof e?new Date(e):e;return isNaN(r.getTime())?"Invalid date":r.toLocaleDateString("en-KE","short"===t?{year:"2-digit",month:"short",day:"numeric",timeZone:"Africa/Nairobi"}:{year:"numeric",month:"long",day:"numeric",weekday:"long",timeZone:"Africa/Nairobi"})},n=(e,t)=>t<=0||t>100?e:e*(1-t/100),i=e=>e?(Math.round(10*e)/10).toFixed(1):"—"},5759:(e,t,r)=>{Promise.resolve().then(r.bind(r,4143))},7671:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(5155);r(2115);var s=r(1559);let l=e=>{let{type:t="custom",title:r,description:l,icon:o,action:n,langSw:i,imageSrc:d,className:c=""}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-6 py-16 px-4 text-center ".concat(c),role:"status","aria-live":"polite",children:[d?(0,a.jsx)("img",{src:d,alt:"",className:"w-32 h-32 md:w-48 md:h-48 opacity-70 object-contain"}):(0,a.jsx)("div",{className:"text-6xl md:text-8xl",children:o||({"no-results":"\uD83D\uDD0D","empty-cart":"\uD83D\uDED2","no-favorites":"❤️","no-orders":"\uD83D\uDCE6",error:"⚠️",custom:"\uD83D\uDCED"})[t]}),(0,a.jsxs)("div",{className:"space-y-2 max-w-sm",children:[(0,a.jsx)("h2",{className:"text-h3 md:text-h2 font-montserrat font-bold text-road-grey-900",children:r}),l&&(0,a.jsx)("p",{className:"text-body-md text-road-grey-700",children:l}),i&&(0,a.jsxs)("div",{className:"pt-2 border-t border-road-grey-300 mt-4",children:[(0,a.jsx)("p",{className:"text-body-md text-road-grey-700 italic",children:i.title}),i.description&&(0,a.jsx)("p",{className:"text-body-sm text-road-grey-500",children:i.description})]})]}),n&&(0,a.jsx)(s.A,{variant:"primary",size:"lg",onClick:n.onClick,className:"mt-4",children:n.label})]})}},8214:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(5155);r(2115);let s=e=>{let{size:t="md",fullScreen:r=!1,message:s}=e,l=(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,a.jsx)("div",{className:"".concat({sm:"w-8 h-8 border-2",md:"w-12 h-12 border-4",lg:"w-16 h-16 border-4"}[t]," border-road-grey-300 border-t-mechanic-blue rounded-full animate-spin-wheel")}),s&&(0,a.jsx)("p",{className:"text-body-md text-road-grey-700 font-montserrat font-semibold text-center max-w-xs",children:s})]});return r?(0,a.jsx)("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center z-50",children:l}):l}}},e=>{e.O(0,[619,8,663,44,623,358],()=>e(e.s=5759)),_N_E=e.O()}]);